<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Online Election System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
  margin:0;
  font-family:"Segoe UI", Arial, sans-serif;
  background:#f4f6fb;
  color:#111;
}

/* LOGIN */
#loginPage{
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.loginBox{
  background:#fff;
  width:360px;
  padding:30px;
  border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
}
.loginBox h2{text-align:center}

/* COMMON */
label{display:block;margin-top:14px;font-weight:600}
input,textarea,select{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  width:100%;
  margin-top:18px;
  padding:12px;
  border:none;
  border-radius:6px;
  background:#2563eb;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}
button:hover{background:#1e4ed8}

/* APP */
#app{display:none}
.container{
  display:grid;
  grid-template-columns:230px 1fr;
  min-height:100vh;
}

/* SIDEBAR */
.sidebar{
  background:#fff;
  border-right:1px solid #ddd;
  padding:20px;
}
.step{
  padding:12px;
  margin-bottom:10px;
  background:#eef2ff;
  border-radius:6px;
  cursor:pointer;
  font-weight:600;
}
.step i{color:#000;margin-right:6px}
.step.active,.step:hover{
  background:#2563eb;
  color:#fff;
}

/* MAIN */
.main{padding:30px}
.section{display:none}
.section.active{display:block}

/* FORM CARD */
.form-card{
  background:#fff;
  max-width:820px;
  margin:auto;
  padding:30px;
  border-radius:12px;
  box-shadow:0 8px 25px rgba(0,0,0,.1);
}
.navBtns{
  display:flex;
  gap:12px;
  margin-top:25px;
}
.navBtns button{flex:1}

/* CANDIDATE */
.candidate{
  background:#eef2ff;
  padding:14px;
  border-radius:6px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

/* MODALS */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  align-items:center;
  justify-content:center;
}
.modalBox{
  background:#fff;
  padding:25px;
  border-radius:10px;
  width:320px;
  text-align:center;
}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #ccc;
  padding:10px;
  text-align:center;
}
th{background:#eef2ff}

@media(max-width:768px){
  .container{grid-template-columns:1fr}
  .sidebar{display:none}
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage">
  <div class="loginBox">
    <h2><i class="fa fa-right-to-bracket"></i> Election Login</h2>
    <label>Email</label>
    <input id="loginEmail">
    <label>Password</label>
    <input id="loginPass" type="password">
    <button onclick="login()">Login</button>
  </div>
</div>

<!-- APP -->
<div id="app">
<div class="container">

<!-- SIDEBAR -->
<div class="sidebar">
  <div class="step active" onclick="openStep(1)"><i class="fa fa-user"></i> Registration</div>
  <div class="step" onclick="openStep(2)"><i class="fa fa-users"></i> Family</div>
  <div class="step" onclick="openStep(3)"><i class="fa fa-location-dot"></i> Address</div>
  <div class="step" onclick="openStep(4)"><i class="fa fa-check-to-slot"></i> Vote</div>
  <div class="step" onclick="openStep(5)"><i class="fa fa-chart-column"></i> Results</div>
</div>

<!-- MAIN -->
<div class="main">

<!-- STEP 1 -->
<div id="step1" class="section active">
<div class="form-card">
<h2>User Registration</h2>

<label>Full Name</label>
<input id="name">

<label>Gender</label>
<select id="gender">
<option value="">Select</option>
<option>Male</option>
<option>Female</option>
<option>Other</option>
</select>

<label>Aadhar</label>
<input id="aadhar">

<label>Voter ID</label>
<input id="voterId" placeholder="VOT-CBE-2026-001">

<label>Phone</label>
<input id="phone">

<label>DOB</label>
<input id="dob" placeholder="DD/MM/YYYY" maxlength="10" oninput="formatDOB(this);calcAge()">

<label>Age</label>
<input id="age" readonly>

<div class="navBtns">
<button onclick="validateStep1()">Next</button>
</div>
</div>
</div>

<!-- STEP 2 -->
<div id="step2" class="section">
<div class="form-card">
<h2>Family Details</h2>
<label>Father Name</label><input>
<label>Mother Name</label><input>
<div class="navBtns">
<button onclick="openStep(1)">Previous</button>
<button onclick="openStep(3)">Next</button>
</div>
</div>
</div>

<!-- STEP 3 -->
<div id="step3" class="section">
<div class="form-card">
<h2>Address & Polling Booth</h2>

<label>Address</label>
<textarea></textarea>

<label>District</label>
<input value="Coimbatore">

<label>State</label>
<input value="Tamil Nadu">

<label>Polling Booth</label>
<input value="Coimbatore Central School">

<h3>üìç Booth Location</h3>
<iframe width="100%" height="280"
src="https://www.google.com/maps?q=Coimbatore%20Polling%20Booth&output=embed"
style="border:0;border-radius:10px"></iframe>

<div class="navBtns">
<button onclick="openStep(2)">Previous</button>
<button onclick="openStep(4)">Next</button>
</div>
</div>
</div>

<!-- STEP 4 -->
<div id="step4" class="section">
<div class="form-card">
<h2>Vote</h2>

<div class="candidate">
<span>Rahul Sharma</span>
<button onclick="confirmVote('Rahul Sharma')">Vote</button>
</div>

<div class="candidate">
<span>Kavya Mehta</span>
<button onclick="confirmVote('Kavya Mehta')">Vote</button>
</div>

</div>
</div>

<!-- STEP 5 -->
<div id="step5" class="section">
<div class="form-card">
<h2>Election Results</h2>

<div id="voteStatusBox"></div>
<div id="resultsBox"></div>

<h3>Voters Record</h3>
<table id="voterTable">
<tr><th>Voter ID</th><th>Name</th><th>Candidate</th><th>Time</th></tr>
</table>

<button onclick="downloadReceipt()">Download Receipt</button>
<button onclick="logout()">Logout</button>
</div>
</div>

</div>
</div>
</div>

<!-- OTP MODAL -->
<div id="otpModal" class="modal">
  <div class="modalBox">
    <h3>OTP Verification</h3>
    <input id="otpInput" placeholder="Enter OTP">
    <button onclick="verifyOTP()">Verify</button>
  </div>
</div>

<script>
let selectedCandidate=null,generatedOTP=null;

function login(){
  if(loginEmail.value==""||loginPass.value==""){alert("Enter login");return;}
  loginPage.style.display="none";
  app.style.display="block";
}

function openStep(n){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById("step"+n).classList.add("active");
  document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll(".step")[n-1].classList.add("active");
  if(n==5) loadResults();
}

function formatDOB(i){
  let v=i.value.replace(/\D/g,"");
  if(v.length>2&&v.length<=4)v=v.slice(0,2)+"/"+v.slice(2);
  else if(v.length>4)v=v.slice(0,2)+"/"+v.slice(2,4)+"/"+v.slice(4,8);
  i.value=v;
}
function calcAge(){
  if(dob.value.length==10){
    let d=dob.value.split("/");
    age.value=new Date().getFullYear()-d[2];
  }
}

function validateStep1(){
  if(name.value==""||gender.value==""||voterId.value==""){alert("Fill all");return;}
  openStep(2);
}

function confirmVote(c){
  selectedCandidate=c;
  generatedOTP=Math.floor(100000+Math.random()*900000);
  alert("Demo OTP: "+generatedOTP);
  otpModal.style.display="flex";
}

function verifyOTP(){
  if(otpInput.value==generatedOTP){
    otpModal.style.display="none";
    castVote();
  }else alert("Invalid OTP");
}

function castVote(){
  let votes=JSON.parse(localStorage.getItem("votes")||"{}");
  votes[selectedCandidate]=(votes[selectedCandidate]||0)+1;
  localStorage.setItem("votes",JSON.stringify(votes));

  let rec={
    voter:voterId.value,
    name:name.value,
    candidate:selectedCandidate,
    time:new Date().toLocaleString()
  };
  localStorage.setItem("receipt_"+voterId.value,JSON.stringify(rec));

  voteStatusBox.innerHTML="‚úÖ OTP Verified<br>üó≥ Vote Status: SUCCESS";
  openStep(5);
}

function loadResults(){
  let votes=JSON.parse(localStorage.getItem("votes")||"{}");
  let html="",max=0,winner="";
  for(let c in votes){
    html+=`${c} : ${votes[c]} votes<br>`;
    if(votes[c]>max){max=votes[c];winner=c;}
  }
  resultsBox.innerHTML=html+"<br><b>Winner:</b> "+winner;

  let r=JSON.parse(localStorage.getItem("receipt_"+voterId.value));
  if(r){
    voterTable.innerHTML+=`<tr><td>${r.voter}</td><td>${r.name}</td><td>${r.candidate}</td><td>${r.time}</td></tr>`;
  }
}

function downloadReceipt(){
  let r=JSON.parse(localStorage.getItem("receipt_"+voterId.value));
  let t=`VOTER ID: ${r.voter}\nNAME: ${r.name}\nVOTED: ${r.candidate}\nTIME: ${r.time}`;
  let b=new Blob([t]);
  let a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="vote_receipt.txt";
  a.click();
}

function logout(){location.reload();}
</script>

</body>
</html>
